<!DOCTYPE HTML>
<html ng-app='wordReminder'>
	<head>
		<title>GRE Word Reminder WordList</title>
	</head>
	<body>
		<div class="mdl-grid" ng-controller='listController as ctrl'>
			<div class="mdl-cell mdl-cell--6-col mdl-cell--12-col-phone mdl-cell--3-offset-desktop ">
					<form class='mdl-grid' ng-submit="ctrl.onSubmit()">
						<div class="mdl-cell mdl-cell--8-col mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<input class="mdl-textfield__input" type="text" id="newWord" pattern="[A-Z,a-z]*" ng-model='ctrl.newWord'>
							<label class="mdl-textfield__label" for="newWord">New Word</label>
							<span class="mdl-textfield__error">Letters only</span>
						</div>
						<div class='mdl-cell mdl-cell--2-col mdl-cell--2-offset'>
							<button class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-button--colored">
								<i class="material-icons">add</i>
							</button>
						</div>
					</form>
				<ul class='mdl-list'>
					<div ng-repeat='word in ctrl.words track by $index'>
						<li class="mdl-list__item">
							<span class="mdl-list__item-primary-content">
								{{word}}
							</span>
							<a class="mdl-list__item-secondary-action" ng-click='ctrl.onDelete(word)' style="cursor: pointer;"><i class="material-icons">delete</i></a>
						</li>
					</div>
				</ul>
			</div>
	</div>
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
		<script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
		<script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js'></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-resource.js"></script>
		<script>
			angular.module('wordReminder', ['ngResource'])
			  .controller('listController', ['$resource', function($resource) {
				var ctrl = this;
			  	this.words=[];
			  	var listResource = $resource('http://gre-reminder-service.herokuapp.com/word');
				var wholeList = listResource.query({all: true}, ()=>this.words=wholeList );
				function updateList(){
					let wholeList = listResource.query({all: true}, ()=>ctrl.words=wholeList );
				}
				this.onSubmit = ()=>listResource.save({word: ctrl.newWord},{},()=>{
					ctrl.newWord='';
					updateList();
				});
				this.onDelete = (word)=>listResource.delete({word: word},{},updateList);
			  }]);
		</script>
	</body>
</html>